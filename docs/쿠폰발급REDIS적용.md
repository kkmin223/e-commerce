## 쿠폰 선착순 발급 시스템 Redis 적용 보고서

---

### 1. 아키텍처 개요

- 사용자 요청 시 실시간 대기열 등록
- 스케줄러 기반 발급 처리
- 중복 발급 방지

---

### 2. 주요 구현 내용

#### 2.1 실시간 대기열 관리 (Sorted Set 활용)

- 사용자가 쿠폰 발급을 요청하면 Redis의 Sorted Set에 쿠폰 ID별로 사용자 ID를 저장하고, score에는 요청 시각(타임스탬프)을 기록합니다.
- 이를 통해 요청 순서가 자동으로 정렬되어, 선착순 처리가 용이합니다.

#### 2.2 스케줄러 기반 발급 처리

- 스케줄러가 1분마다 동작하여 각 쿠폰별로 대기열 상위 10명의 사용자 정보를 조회합니다.
- 조회된 사용자 중 실제 발급 가능한 대상만 선별하여 발급 처리합니다.
- 발급이 완료된 사용자는 대기열에서 제거하여 중복 처리를 방지합니다.

#### 2.3 중복 발급 방지 (Set 활용)

- 쿠폰별로 Redis Set을 이용해 이미 발급된 사용자 ID를 저장합니다.
- 발급 처리 시 Set에 이미 존재하는 사용자인 경우 발급 대상에서 제외하여, 중복 발급을 원천적으로 차단합니다.

---

### 3. 장점

1. **정확한 선착순 처리**
    - 요청 시각을 기준으로 자동 정렬되어 공정한 선착순 발급이 가능합니다.

2. **중복 발급 방지**
    - Redis Set의 중복 불허 특성을 활용해, 사용자별 1회 발급을 보장합니다.

3. **확장성과 실시간성**
    - Redis의 빠른 연산 성능 덕분에 대량의 동시 요청에도 안정적으로 동작합니다.

4. **자동화된 발급 관리**
    - 스케줄러를 통해 주기적으로 발급을 처리하여 운영 부담을 줄였습니다.

